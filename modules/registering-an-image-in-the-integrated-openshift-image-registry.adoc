:_module-type: PROCEDURE

[id='registering-an-image-in-the-integrated-openshift-image-registry_{context}']
= Registering an image in the integrated OpenShift image registry

To make an image available to other users in your OpenShift cluster, you can register the image in the _integrated OpenShift image registry_, a built-in container image registry.

For more information about the integrated OpenShift image registry, see link:https://docs.openshift.com/container-platform/4.16/registry/index.html#registry-integrated-openshift-registry_registry-overview[Integrated OpenShift image registry].

.Prerequisites

* You have `cluster-admin` access to the OpenShift Console for the cluster where {productname-short} is installed. 

ifndef::upstream[]
* You can access a data science project that contains a workbench, and the workbench is running a default notebook image that contains the CodeFlare SDK, for example, the *Standard Data Science* notebook. For information about how to create a project, see link:{rhoaidocshome}{default-format-url}/working_on_data_science_projects/using-data-science-projects_projects#creating-a-data-science-project_projects[Creating a data science project]. 
endif::[]
ifdef::upstream[]
* You can access a data science project that contains a workbench, and the workbench is running a default notebook image that contains the CodeFlare SDK, for example, the *Standard Data Science* notebook. For information about how to create a project, see link:{odhdocshome}/working-on-data-science-projects/#creating-a-data-science-project_projects[Creating a data science project]. 
endif::[]

* You have Podman installed in your local environment.
+
For more information about Podman and container registries, see link:https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/building_running_and_managing_containers/index[Building, running, and managing containers].


.Procedure

. In a terminal window, log in to the OpenShift CLI as shown in the following example:
+
[source,subs="+quotes"]
----
$ oc login __<openshift_cluster_url>__ -u __<admin_username>__ -p __<password>__
----

. Set the `IMG` environment variable to the name of your image.
In the example commands in this section, `ray-torch` is the name of the image.
+
.Set the environment variable
[source,subs="+quotes"]
----
export IMG=ray-torch
----


. Expose the integrated image registry so that you can access the registry from outside the cluster, for example, from a notebook or pipeline: 
+
.Expose the registry
[source,subs="+quotes"]
----
oc patch configs.imageregistry.operator.openshift.io/cluster --patch \'{"spec":{"defaultRoute":true}}' --type=merge
----
 
. Wait for the route to the integrated image registry to be admitted: 
+
.Wait for admission
[source,subs="+quotes"]
----
oc wait -n openshift-image-registry route/default-route --for=jsonpath=\'{.status.ingress[0].conditions[0].status}'=True
----

. Log in to the integrated image registry:
+
[source,subs="+quotes"]
----
podman login -u $(oc whoami) -p $(oc whoami -t) $(oc registry info)
----

. Tag the image for the integrated image registry:
+
.Tag the image
[source,subs="+quotes"]
----
podman tag ${IMG} $(oc registry info)/$(oc project -q)/${IMG}
----

. Push the image to the integrated image registry:
+
.Push the image
[source,subs="+quotes"]
----
podman push $(oc registry info)/$(oc project -q)/${IMG}
----

. Retrieve the image repository location for the tag that you want:
+
.Retrieve the image location
[source,subs="+quotes"]
----
oc get is ${IMG} -o jsonpath=\'{.status.tags[?(@.tag=="_<TAG>_")].items[0].dockerImageReference}'
----
+
Any user can now use your image by specifying this retrieved image location value in the `image` parameter of a notebook or pipeline.
